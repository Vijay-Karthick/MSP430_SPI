/**
 * File: main.c
 * Description: Main entry point.
 * Author: Vijay Karthick Baskar.
 * License: Assume BSD type license and feel free to use this code.
 *			Sending me a thank you mail will do!
 */

/*
 *------------------------------------------------------------------------------
 * Include Files
 *------------------------------------------------------------------------------
 */

#include "startup.h"

/*
 *------------------------------------------------------------------------------
 * Private Defines
 *------------------------------------------------------------------------------
 */

/*
 *------------------------------------------------------------------------------
 * Private Macros
 *------------------------------------------------------------------------------
 */

/*
 *------------------------------------------------------------------------------
 * Private Data Types
 *------------------------------------------------------------------------------
 */

/*
 *------------------------------------------------------------------------------
 * Public Variables
 *------------------------------------------------------------------------------
 */

/*
 *------------------------------------------------------------------------------
 * Private Variables
 *------------------------------------------------------------------------------
 */

volatile unsigned int i;

/*
 *------------------------------------------------------------------------------
 * Public Constants
 *------------------------------------------------------------------------------
 */

/*
 *------------------------------------------------------------------------------
 * Private Constants
 *------------------------------------------------------------------------------
 */

/*
 *------------------------------------------------------------------------------
 * Private Function Prototypes
 *------------------------------------------------------------------------------
 */

/*
 *------------------------------------------------------------------------------
 * Public Function Definitions
 *------------------------------------------------------------------------------
 */

void main(void) {
	/* Disable the watchdog */
	disable_watchdog();

	/* Initialize the system clock */
	clock_init();

	/* Initialzie thw WDOG timer */
	init_wdog();

	/* Initialize the GPIO */
	gpio_init();

	/* Initialize the SPI */
	spi_init();

	/* Enable the WDOG */
	enable_watchdog();

	/* forever loop */
	for (;;) {
		/* Reset WDOG timer to prevent resetting the CPU */
		reset_wdog();

		/* Test transmit */
		while (UCA0STAT & DATA_TRANSFER_IN_PROGRESS);
		TRANSMIT_BUFFER = 0xAB;
	}
}
